=Overview=

*Please note that this page is currently work in progress!* See also section [#Next_steps next steps].

This page helps you getting started with the JSR 311 plugin for Grails. It is assumed that you have a basic understanding of [http://www.grails.org Grails] and the [http://jcp.org/en/jsr/detail?id=311 JSR 311] (JAX-RS: The Java API for RESTful Web Services).

=Prerequisites=

  * A Grails 1.1.1 (or higher) installation. For instructions how to download and install Grails refer to the [http://grails.org/doc/1.1/ Grails reference documentation] section 2.1. 

=Obtain the plugin=

Either download the latest plugin binary directly from [http://code.google.com/p/grails-jaxrs/downloads/list directly from here] or build it from its sources:

  * Checkout the code from Subversion via {{{svn checkout http://grails-jaxrs.googlecode.com/svn/trunk/jaxrs jaxrs}}}
  * Go to the created {{{jaxrs}}} directory.
  * Enter {{{grails test-app}}} on the command line to run the unit and integration tests (optional)
  * Enter {{{grails package-plugin}}} on the command line to create the plugin binary

The filename of the created plugin is {{{grails-jaxrs-<version>.zip}}} where {{{<version}}} is the current development version. Alternatively you may want to build the plugin from one of the [http://grails-jaxrs.googlecode.com/svn/tags tagged versions].

=Create a project=

To use the plugin we create a new Grails project. Change the working directory to a location where yuo want to create a new Grails project and enter 

{{{grails create-app hello}}} 

on the command line. This creates a new directory {{{hello}}}. Go to this directory and type 

{{{grails install-plugin /path/to/grails-jaxrs-<version>.zip}}} 

where {{{/path/to}}} needs to be replaced by the absolute or relative path to the {{{grails-jaxrs}}} plugin obtained previously.

In order work with JSR 311 annotations and classes you need to add the [http://download.java.net/maven/2/javax/ws/rs/jsr311-api/1.1/jsr311-api-1.1.jar JSR 311 jar file] (version 1.1) to the {{{lib}}} folder of your project.

=Create a resource=

In the {{{hello}}} project under {{{src/groovy}}} create a new Groovy class {{{HelloResource.groovy}}}:

{{{
import javax.ws.rs.GET
import javax.ws.rs.Path
import javax.ws.rs.Produces

import org.springframework.stereotype.Component

@Component
@Path('/test')
class HelloResource {

    @GET
    @Produces('text/plain')
    String greet() {
        'Hello grails-jaxrs'
    }
    
}
}}}

This implements a resource that responds to {{{HTTP GET}}} and  produces representations of content type {{{text/plain}}}. The path of the resource URL is {{{/test}}}.

=Setup the application context=

Before the application can be started we need to add the resource to the Spring application context. We do this with a [http://static.springsource.org/spring/docs/2.5.x/reference/xsd-config.html#xsd-config-body-schemas-context-component-scan component scan]. A component scan looks in the classpath for beans annotated with {{{@Component}}} and adds them to the application context. Here's the application context XML file ({{{resources.xml}}}) that needs to be added to the {{{grails-app/conf/spring}}} directory of the {{{hello}}} project.

{{{
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
http://www.springframework.org/schema/beans 
http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
http://www.springframework.org/schema/context 
http://www.springframework.org/schema/context/spring-context-2.5.xsd">

    <context:annotation-config/>
    <context:component-scan base-package="**"/>

</beans>
}}}

This scans components from all packages including the default package. If you don't want to use {{{context:component-scan}}} add the bean {{{<bean class="HelloResource />"}}} directly to the application context.

=Run the application=

To start the application type 

{{{grails run-app}}}

on the comamnd line. Then open a browser window and go to {{{http://localhost:8080/hello/test}}}. You should now see a "Hello grails-jaxrs" in the browser.

=Next steps=

This documentation will soon be extended to show you how to

  * use Grails controllers besides JAX-RS resources
  * apply Grails filters to JAX-RS resources
  * use Grails object relational mapping (GORM)
  * write your own provider (reader/writer) classes
  * use XML and JSON marshaling in resource and provider classes
  * auto-inject Grails services into resource classes
  * generate resource classes for domain classes
  * deploy your application to Google App Engine
  * ...

=Advanced topics=

==Configuration==

By default all requests are forwarded to the {{{JaxrsController}}} which is contained in the {{{grails-jaxrs}}} plugin. In order to use "regular" Grails controllers besides the {{{JaxrsController}}} we need to extend the URL mappings. 

Instead of extending the {{{grails-app/conf/UrlMappings.groovy}}} file directly the URL mappings for the {{{JaxrsController}}} are set via the {{{org.grails.jaxrs.url.mappings}}} configuration property. The property value is a list of URL patterns. Example:

Assuming that a Grails application is accessible under http://localhost:8080/hello where {{{/hello}}} is the context path and all JAX-RS resources are accessible via

  * http://localhost:8080/hello/test/... and
  * http://localhost:8080/hello/notes/...

we need to add the following entry to {{{grails-app/conf/Config.groovy}}}:

  * {{{org.grails.jaxrs.url.mappings=['/test', '/notes']}}}

This ensures that only requests with a URL path matching {{{/test/**}}} and {{{/notes/**}}} are forwarded to the {{{JaxrsController}}}, all other requests are processed the "usual Grails way".
